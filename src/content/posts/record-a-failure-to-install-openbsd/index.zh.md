---
pubDate: '2022-08-06 15:50:21'
---

# 记录一次安装 OpenBSD 翻车

之前一直想尝试 FreeBSD，无奈当时 FreeBSD 对 AX200 的支持还是不太友好(起码我的设备是这样)，这次闲来无事，准备尝试一下据说早就支持 AX200 的 OpenBSD。

然后翻车了。<!--more-->

## 安装准备

抱着不作死不休和“我根本没有重要的数据”的想法，我没有进行任何避险操作，草草的 `btrfs subv snapshot` 过后就开始安装，没有备份昨天晚上那几个还没 push 的 commit，备份完的分区表放在了原来磁盘的分区里(wssb)。

简单下载刻录镜像(没有校验)，我便重启电脑，连官方的文档都没有看就直接盲操。

## 安装

前面的几步挺顺利的，我也没有留图，当然这些都不重要。到了分区这一步，用的是 OpenBSD 的 `fdisk`，貌似和 Linux 下的不太一样？好，按 `m` 查看文档。哇好长的文档，按 `j` 往下翻。2k 屏幕一行一行翻页好卡啊，试试 `<C-d>`，哇，居然可以用。还是好卡(疯狂按)。

沃日，怎么翻页翻完了还能直接退出的，还多摁了几个 `<C-d>` 搁缓冲区哇 😐。

## 翻车

既然有自定义分区，那肯定也有全盘安装和自动分区，很不巧的是全盘安装的选项在第一个，多翻的那几页直接给我全盘安装 + 确认一条龙。

意识到不对劲的我赶紧看了下分区表，确实被干的稀碎。

我傻了，连图都忘了截。

## 亡羊补牢

新分区表建好后倒是没有再写入什么内容，但我原来 Linux 的分区是 LUKS+btrfs 的组合，感觉随便出点事就是数据火葬场。

Google 后找到了这个[补救方法](https://unix.stackexchange.com/questions/364229/recover-deleted-luks-partition)，这次可不敢不看文档了。

![定位分区](https://s2.loli.net/2022/10/02/SE3AbV7efRr5n9L.jpg)

![临时挂载](https://s2.loli.net/2022/10/02/CluakozdyGxPTMH.jpg)

跟着老哥的操作倒是很顺利的找到了原来的分区的位置，建立好新分区修改好标识后，剩下的分区用 DiskGenius 很轻松就找回来了，不过接下来才是关键时刻，直接 `btrfs scrub`

![rip](https://s2.loli.net/2022/10/02/H9a6ktgDqZSfLIx.jpg)

应该是没救了(悲

好在 @home 子卷下的文件大部分都没事，也不知道什么原理。备份了 @home 子卷 和 /etc 分区后开始准备重装系统了。

## 恢复

因为原来使用的 Linux 发行版是 Gentoo，又十分不幸，之前构建好的 binpkgs 似乎无一幸免，重装过程只能说异常痛苦(其实也就是配置拉完然后编译了一夜)。

剩下的几个分区还没有测试，目前使用看来倒没发现有什么文件损坏，不过这些分区里面倒是真的没有重要文件就是了。

## 总结

其实感觉这种事发生概率还挺低的，最主要的还是我过于 sb 也不备份也不虚拟机测试也不看文档直接在主力机上尝试安装没接触过的系统，希望广大网友引以为戒(

其实在安装系统的前一天我就把家里旧电脑上的一块硬盘格式化成了 btrfs，打算拿来作备份。但第一次 `btrfs send` 实在是太耗时，嫌麻烦就没搞 😭。

从接触电脑到现在，这是我第二次在安装系统上翻车，只能说受到的教训还是太少了，没有真切的体会到备份的重要性，这次可算是吃了大亏。

可是我懒癌又犯了，除了受伤的电脑还有几台服务器要备份，手头上也没有什么储存介质能承受一次完整备份和后续的增量备份，只能说下次一定 🤕。
